var Chunk=function(resource,connections,callback){this.connections=connections,this.chunk=0,this.size=0,console.log(resource),this.parts=this.len(resource),this.source=resource,this.each_chunk_callback=callback};Chunk.prototype.len=function(resource){var http=new XMLHttpRequest;http.open("HEAD",resource,!1),http.setRequestHeader("Accept","image/webp"),http.onreadystatechange=function(){http.readyState==http.DONE&&(length=http.getResponseHeader("Content-Length"),this.size=length)}.bind(this),http.send()},Chunk.prototype.download=function(){var length=this.size,difference=Math.floor(length/this.connections),modulo=difference%3;0==modulo?difference-=1:modulo%3==1&&(difference-=2);var start_point=0,i=0;for(i=1;length/difference-1>=i;start_point=end_point+1,i++)end_point=start_point+difference,this.get_part(start_point,end_point,i);return this.get_part(start_point,length-1,i),!0},Chunk.prototype.get_part=function(start_index,end_index,chunk_index){var xmlhttp=new XMLHttpRequest;console.log("Start Index = "+start_index+"End index = "+end_index),xmlhttp.open("GET",this.source,!0),xmlhttp.responseType="arraybuffer",xmlhttp.setRequestHeader("Range","bytes="+start_index+"-"+end_index),xmlhttp.addEventListener("readystatechange",function(){xmlhttp.readyState==xmlhttp.DONE&&this.each_chunk_callback(this.connections,new Uint8Array(xmlhttp.response),"chunk"+chunk_index)}.bind(this)),xmlhttp.send()};